{
  "name": "primordial",
  "version": "1.0.0",
  "description": "Algorithmic trading platform",
  "author": "jasonlscharf@gmail.com",
  "license": "UNLICENSED",
  "private": true,
  "scripts": {
    "build": "yarn dev:build",
    "dev:watch": "tsc -w -p src",
    "dev:compile": "tsc -p src",
    "dev:clean": "rm -rf dist",
    "dev:build": "yarn dev:clean && yarn codegen && yarn dev:compile && yarn release:assets && yarn dc build",
    "dev:up": "yarn dc up -d",
    "dc": "DOCKER_BUILDKIT=0 COMPOSE_DOCKER_CLI_BUILD=0 docker-compose -p primo -f docker-compose.yml -f docker-compose.dev.yml",
    "dev:build-images": "yarn dc build",
    "release:assets": "mkdir -p ./dist && cp package.json ./dist/package.json && cp ./src/roles/tests/intern.json ./dist/intern.json && cp ./src/roles/api/nodemon.json ./dist/api/nodemon.json",
    "release:compile": "ls -lah && yarn dev:clean && yarn codegen && tsc -p src",
    "release:build": "yarn release:compile && yarn release:assets",
    "release:build-images": "DOCKER_BUILDKIT=1 COMPOSE_DOCKER_CLI_BUILD=1 docker-compose -p md build",
    "logs": "yarn kube logs deployments/md-service-deployment --all-containers=true",
    "tail": "yarn logs -f",
    "ex": "docker exec -it core_server_1 sh",
    "up": "yarn build && yarn dc up -d",
    "down": "yarn dc down",
    "up-kube": "yarn dev:build && yarn dev:build-images && yarn kube:apply && yarn kube:restart",
    "up:debug": "yarn up",
    "codegen": "yarn tsoa --basePath src/server -c src/roles/api/tsoa.json spec-and-routes",
    "kube": "kubectl -n default",
    "kube:apply": "yarn kube:config && yarn kube apply -f k8s/manifest.yml",
    "kube:config": "yarn -s kube kustomize k8s/overlays/dev > k8s/manifest.yml",
    "kube:config:release": "yarn -s kube kustomize k8s/overlays/production > k8s/manifest.yml",
    "kube:exec": "yarn kube exec -it deployment/md-service-deployment --",
    "kube:shell": "yarn kube exec -it deployment/md-service-deployment sh",
    "kube:fwd:start": "yarn kube port-forward service/md-service-backend 10000:debug & > /dev/null 2>&1",
    "kube:fwd:stop": "kill $(ps -ef | grep 'kubectl -n default [p]ort-forward' | awk '{print $2}') 2>/dev/null || true",
    "kube:fwd": "yarn kube:fwd:stop && yarn kube:fwd:start",
    "kube:restart": "yarn kube rollout restart deployment",
    "migration:make": "knex --migrations-directory 'src/roles/database/migrations/' migrate:make -x ts",
    "test": "docker-compose -p primo_tests -f docker-compose.yml -f docker-compose.tests.yml up --remove-orphans --abort-on-container-exit --exit-code-from tests --build tests",
    "test:ci": "docker-compose -p primo -f docker-compose.yml -f docker-compose.tests.yml up --remove-orphans --abort-on-container-exit --exit-code-from tests --build tests",
    "test:down": "docker-compose -p primo_tests -f docker-compose.dev.yml -f docker-compose.tests.yml down",
    "test:debug:start": "yarn build && docker-compose -p primo_tests -f docker-compose.yml -f docker-compose.tests.yml up -d",
    "test:debug:stop": "docker-compose -p primo_tests -f docker-compose.yml -f docker-compose.tests.yml down",
    "role:tests:run": "c8 -x **/tests/** -r cobertura node --nolazy /app/node_modules/.bin/intern config=/app/tests/intern.json target=dev",
    "role:api:dev": "nodemon -V --config /app/src/roles/api/nodemon.json",
    "role:worker:dev": "nodemon -V --config /app/src/roles/worker/nodemon.json",
    "role:tests:dev": "nodemon -V --config /app/src/roles/tests/nodemon.json",
    "version:apply": "sh version.sh"
  },
  "devDependencies": {
    "@koa/router": "^9.4.0",
    "@types/applicationinsights": "^0.20.0",
    "@types/commander": "^2.12.2",
    "@types/extract-zip": "^1.6.2",
    "@types/knex": "^0.16.1",
    "@types/koa": "^2.11.5",
    "@types/koa-bodyparser": "^4.3.0",
    "@types/koa-morgan": "^1.0.4",
    "@types/koa-router": "^7.4.1",
    "@types/koa__router": "^8.0.3",
    "@types/node": "^14.11.8",
    "intern": "^4.10.0",
    "nodemon": "^2.0.5",
    "typescript": "^4.0.3"
  },
  "dependencies": {
    "amqplib": "^0.8.0",
    "applicationinsights": "^1.8.7",
    "c8": "^7.7.3",
    "commander": "^6.2.0",
    "extract-zip": "^2.0.1",
    "knex": "^0.95.8",
    "koa": "^2.13.0",
    "koa-bodyparser": "^4.3.0",
    "koa-router": "^9.4.0",
    "morgan": "^1.10.0",
    "pg": "^8.6.0",
    "tslib": "^2.3.0",
    "tsoa": "^3.3.0",
    "typescript-ioc": "^3.2.2"
  }
}
